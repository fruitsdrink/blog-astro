---
title: "expo手势 - 单击&双击"
date: "2025-11-19T00:02:51+08:00"
tags: [expo,react-native, animation]
description: "expo 单击和双击手势处理"
video:
  type: "mux"
  url: "https://player.mux.com/pO02crc3b502Tm8ziqo5knRCjCEY42ef1p4L2NGSgfGrg"
---

import { MuxVideo, Link,Row } from "@/components";

<MuxVideo url="https://player.mux.com/pO02crc3b502Tm8ziqo5knRCjCEY42ef1p4L2NGSgfGrg" />

<Row>
<Link
  url="https://youtu.be/nbEmo0zLJjw?si=LlNplWxcXf98kQoR"
  icon="youtube"
  title="YouTube"
/>

<Link url="https://github.com/fruitsdrink/expo-hero/tree/ch-0001" icon="github" title="GitHub" />
</Row>

## 目录

## 目标

1. 单击图片，隐藏图片下面文字，500毫秒后隐藏。
2. 双击图片，弹出心形图片，500毫秒后隐藏。

## 技术点
- 同时处理单击和双击手势
- 背景图片的使用
- 缩放动画的实现

```jsx
<GestureDetector gesture={Gesture.Exclusive(doubleTap, singleTap)}>
```
*注意：doubleTap和singleTap的顺序，如singleTap在前面，则不会响应doubleTap了*

## package

```json
{
  "react-native-gesture-handler": "~2.28.0",
  "react-native-worklets": "0.5.1",
  "react-native-reanimated": "~4.1.1"
}
```

## 源代码

```jsx title="expo"
import { Stack } from "expo-router";
import { useCallback } from "react";
import { Dimensions, ImageBackground, StyleSheet, View } from "react-native";
import {
  Gesture,
  GestureDetector,
  GestureHandlerRootView,
} from "react-native-gesture-handler";

import Animated, {
  useAnimatedStyle,
  useSharedValue,
  withDelay,
  withSpring,
  withTiming,
} from "react-native-reanimated";

export default function Index() {
  const scale = useSharedValue(0);
  const opacity = useSharedValue(1);

  const rStyle = useAnimatedStyle(() => {
    return {
      transform: [
        {
          scale: scale.value,
        },
      ],
    };
  });

  const rTextStyle = useAnimatedStyle(() => {
    return {
      opacity: opacity.value,
    };
  });

  const onSingleTap = useCallback(() => {
    opacity.value = withTiming(0, undefined, (finished) => {
      if (finished) {
        opacity.value = withDelay(500, withTiming(1));
      }
    });
  }, [opacity]);

  const singleTap = Gesture.Tap().maxDuration(250).onStart(onSingleTap);

  const onDoubleTap = useCallback(() => {
    scale.value = withSpring(1, undefined, (finished) => {
      if (finished) {
        scale.value = withDelay(500, withSpring(0));
      }
    });
  }, [scale]);

  const doubleTap = Gesture.Tap()
    .maxDuration(250)
    .maxDelay(250)
    .numberOfTaps(2)
    .onStart(onDoubleTap);

  return (
    <GestureHandlerRootView style={styles.container}>
      <Stack.Screen options={{ headerShown: false }} />
      <GestureDetector gesture={Gesture.Exclusive(doubleTap, singleTap)}>
        <View>
          <ImageBackground
            source={require("../assets/images/bg.jpg")}
            style={styles.image}
            resizeMode="cover"
          >
            <Animated.Image
              source={require("../assets/images/heart.png")}
              style={[
                styles.image,
                {
                  shadowOffset: {
                    width: 0,
                    height: 20,
                  },
                  shadowOpacity: 0.35,
                  shadowColor: "#000",
                  shadowRadius: 35,
                },
                rStyle,
              ]}
              resizeMode="center"
            />
          </ImageBackground>
        </View>
      </GestureDetector>
      <Animated.Text style={[styles.text, rTextStyle]}>
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis
        harum quos cum. Amet, ipsa obcaecati nihil eaque quas, cumque
        perferendis cum laudantium sapiente vero harum a aspernatur blanditiis
        deserunt nobis.
      </Animated.Text>
    </GestureHandlerRootView>
  );
}

const { width: SIZE } = Dimensions.get("window");

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: "center",
    alignItems: "center",
    backgroundColor: "#262626",
  },
  image: {
    width: SIZE,
    height: SIZE,
  },
  text: {
    color: "#fff",
    padding: 16,
    marginTop: 32,
    textAlign: "justify",
  },
});
```

