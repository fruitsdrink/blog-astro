---
title: "动画进度条"
date: "2025-11-17T13:41:22+08:00"
tags: [css, js, progress, animation]
description: "使用 requestAnimationFrame 实现的平滑动画进度条，支持渐变背景、百分比显示和动画控制，展示现代前端动画技术"
cover:
  image: "./images/cover.png"
  title: "动画进度条"
  hiddenInSingle: true
preview:
  enabled: false
  height: 300
---

<iframe
  src="//player.bilibili.com/player.html?isOutside=true&aid=115535626966331&bvid=BV1w6CLBWEaC&cid=33941292492&p=1"
  scrolling="no"
  border="0"
  frameborder="no"
  framespacing="0"
  allowfullscreen="true"
  class="w-full aspect-video mb-4"
></iframe>

## 目录

## 视觉效果

这是一个**动画进度条**组件，具有以下特点：

1. **渐变背景**：进度条使用蓝绿渐变（`#3498db` → `#2ecc71`）
2. **平滑动画**：使用 `requestAnimationFrame` 实现 60fps 流畅动画
3. **百分比显示**：实时显示进度百分比，居中显示在进度条内
4. **交互控制**：支持开始加载和重置功能
5. **视觉反馈**：按钮 hover 效果，进度条过渡动画

## CSS 关键知识点

### 1. **渐变背景实现** (46 行)

```css
.progress-bar {
  background: linear-gradient(90deg, #3498db, #2ecc71);
}
```

- **作用**：创建从左到右的线性渐变
- **方向**：`90deg` 表示水平方向（从左到右）
- **颜色**：蓝色到绿色的渐变，增强视觉吸引力
- **优势**：比纯色更现代、更有层次感

### 2. **内阴影效果** (40 行)

```css
.progress-container {
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}
```

- **inset**：内阴影，在容器内部产生阴影
- **作用**：创建凹陷效果，增强进度条的立体感
- **参数**：`0 2px 4px` 表示无水平偏移，垂直偏移 2px，模糊半径 4px

### 3. **绝对定位居中** (52-55 行)

```css
.progress-percent {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
```

- **定位技巧**：使用 `absolute` + `transform` 实现完美居中
- **原理**：`top: 50%; left: 50%` 定位到父元素中心点，`translate(-50%, -50%)` 偏移自身宽高的一半
- **优势**：不依赖元素尺寸，自适应居中

### 4. **CSS 过渡动画** (48 行)

```css
.progress-bar {
  transition: width 0.5s ease-out;
}
```

- **作用**：当宽度变化时产生平滑过渡
- **时长**：`0.5s` 过渡时间
- **缓动**：`ease-out` 先快后慢的缓动效果
- **注意**：虽然使用 JS 控制动画，但 CSS transition 作为备用，确保平滑

### 5. **Flexbox 布局** (17-19, 61-65 行)

```css
body {
  display: flex;
  justify-content: center;
  align-items: center;
}
.controls {
  display: flex;
  gap: 12px;
  justify-content: center;
}
```

- **页面居中**：使用 Flexbox 实现页面内容水平垂直居中
- **按钮布局**：使用 `gap` 属性设置按钮间距（现代 CSS 特性）
- **响应式**：`flex-wrap: wrap` 支持按钮换行

### 6. **按钮交互效果** (78-81 行)

```css
.controls .btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
}
```

- **悬停效果**：向上移动 2px，增强阴影
- **视觉反馈**：提供清晰的交互反馈
- **过渡**：配合 `transition: all 0.3s ease` 实现平滑过渡

## JavaScript 关键知识点

### 1. **requestAnimationFrame 动画循环** (120-129 行)

```javascript
function animate() {
  if (progress < 100) {
    progress += 0.8;
    updateProgress();
    animationId = requestAnimationFrame(animate);
  } else {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
}
```

- **作用**：创建平滑的动画循环，与浏览器刷新率同步（通常 60fps）
- **优势**：比 `setInterval` 更高效，自动暂停（标签页不可见时）
- **性能**：浏览器优化，GPU 加速支持
- **增量**：每次增加 0.8%，控制动画速度

### 2. **防止重复执行** (115 行)

```javascript
if (animationId) return; // 防止重复点击开始动画
```

- **作用**：防止用户多次点击导致动画重复执行
- **实现**：检查 `animationId` 是否存在，存在则直接返回
- **重要性**：避免内存泄漏和性能问题

### 3. **数值处理与边界控制** (136 行)

```javascript
const value = Math.min(Math.floor(progress), 100);
```

- **Math.floor()**：向下取整，确保百分比为整数
- **Math.min()**：限制最大值不超过 100
- **作用**：确保进度值在 0-100 范围内，避免显示错误

### 4. **动画清理机制** (142-150 行)

```javascript
function resetProgress() {
  if (animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
  progress = 0;
  updateProgress();
}
```

- **清理动画**：使用 `cancelAnimationFrame` 取消正在进行的动画
- **重置状态**：将 `animationId` 设为 `null`，允许重新开始
- **立即更新**：调用 `updateProgress()` 立即更新 UI

### 5. **DOM 操作优化** (137-138 行)

```javascript
progressBar.style.width = `${value}%`;
percentText.textContent = `${value}%`;
```

- **直接操作**：直接修改 DOM 样式和内容
- **性能**：在 `requestAnimationFrame` 中执行，与浏览器渲染同步
- **模板字符串**：使用 ES6 模板字符串，代码更清晰

## 技术亮点总结

✅ **高性能动画**：使用 `requestAnimationFrame` 实现 60fps 流畅动画  
✅ **防重复执行**：通过 `animationId` 检查防止动画重复启动  
✅ **优雅的视觉设计**：渐变背景、内阴影、文字阴影增强视觉层次  
✅ **响应式布局**：Flexbox 实现自适应居中布局  
✅ **完善的交互反馈**：按钮 hover 效果、平滑过渡动画  
✅ **代码结构清晰**：函数职责单一，易于维护和扩展

源代码可关注公众号 **艾恩小灰灰** 获取
