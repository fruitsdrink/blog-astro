---
import { HtmlPreview } from "@/components";
import { BaseLayout } from "@/layouts";
import { Image } from "astro:assets";
import { getCollection } from "astro:content";

const posts = (await getCollection('posts')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);
---

<BaseLayout>
  <section class="max-w-[768px] mx-auto p-6 flex flex-col gap-6">
      {
        posts.map((post) => (
          <article class="bg-white p-6 rounded-md">
            <a href={`/posts/${post.id}`}>
            {post.data.cover?.image &&(
              <Image class="rounded-md" width={720} height={360} src={post.data.cover.image} alt={post.data.title} />
            )}
            {post.data.preview?.enabled && (
              <HtmlPreview postId={post.id} height={post.data.preview?.height} />
            )}
            <h4 class="text-lg font-bold mt-6">{post.data.title}</h4>

            <p class="text-sm text-gray-500 mt-2">{post.data.description}</p>
            <p class="text-sm text-gray-500 mt-4">{post.data.date.toLocaleDateString()}</p>
            </a>
          </article>
        ))
      }
  </section>
</BaseLayout>
